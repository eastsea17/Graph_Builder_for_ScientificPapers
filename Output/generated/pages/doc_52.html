<style>
.lx-highlight { position: relative; border-radius:3px; padding:1px 2px;}
.lx-highlight .lx-tooltip {
  visibility: hidden;
  opacity: 0;
  transition: opacity 0.2s ease-in-out;
  background: #333;
  color: #fff;
  text-align: left;
  border-radius: 4px;
  padding: 6px 8px;
  position: absolute;
  z-index: 1000;
  bottom: 125%;
  left: 50%;
  transform: translateX(-50%);
  font-size: 12px;
  max-width: 240px;
  white-space: normal;
  box-shadow: 0 2px 6px rgba(0,0,0,0.3);
}
.lx-highlight:hover .lx-tooltip { visibility: visible; opacity:1; }
.lx-animated-wrapper { max-width: 100%; font-family: Arial, sans-serif; }
.lx-controls {
  background: #fafafa; border: 1px solid #90caf9; border-radius: 8px;
  padding: 12px; margin-bottom: 16px;
}
.lx-button-row {
  display: flex; justify-content: center; gap: 8px; margin-bottom: 12px;
}
.lx-control-btn {
  background: #4285f4; color: white; border: none; border-radius: 4px;
  padding: 8px 16px; cursor: pointer; font-size: 13px; font-weight: 500;
  transition: background-color 0.2s;
}
.lx-control-btn:hover { background: #3367d6; }
.lx-progress-container {
  margin-bottom: 8px;
}
.lx-progress-slider {
  width: 100%; margin: 0; appearance: none; height: 6px;
  background: #ddd; border-radius: 3px; outline: none;
}
.lx-progress-slider::-webkit-slider-thumb {
  appearance: none; width: 18px; height: 18px; background: #4285f4;
  border-radius: 50%; cursor: pointer;
}
.lx-progress-slider::-moz-range-thumb {
  width: 18px; height: 18px; background: #4285f4; border-radius: 50%;
  cursor: pointer; border: none;
}
.lx-status-text {
  text-align: center; font-size: 12px; color: #666; margin-top: 4px;
}
.lx-text-window {
  font-family: monospace; white-space: pre-wrap; border: 1px solid #90caf9;
  padding: 12px; max-height: 260px; overflow-y: auto; margin-bottom: 12px;
  line-height: 1.6;
}
.lx-attributes-panel {
  background: #fafafa; border: 1px solid #90caf9; border-radius: 6px;
  padding: 8px 10px; margin-top: 8px; font-size: 13px;
}
.lx-current-highlight {
  border-bottom: 4px solid #ff4444;
  font-weight: bold;
  animation: lx-pulse 1s ease-in-out;
}
@keyframes lx-pulse {
  0% { text-decoration-color: #ff4444; }
  50% { text-decoration-color: #ff0000; }
  100% { text-decoration-color: #ff4444; }
}
.lx-legend {
  font-size: 12px; margin-bottom: 8px;
  padding-bottom: 8px; border-bottom: 1px solid #e0e0e0;
}
.lx-label {
  display: inline-block;
  padding: 2px 4px;
  border-radius: 3px;
  margin-right: 4px;
  color: #000;
}
.lx-attr-key {
  font-weight: 600;
  color: #1565c0;
  letter-spacing: 0.3px;
}
.lx-attr-value {
  font-weight: 400;
  opacity: 0.85;
  letter-spacing: 0.2px;
}

/* Add optimizations with larger fonts and better readability for GIFs */
.lx-gif-optimized .lx-text-window { font-size: 16px; line-height: 1.8; }
.lx-gif-optimized .lx-attributes-panel { font-size: 15px; }
.lx-gif-optimized .lx-current-highlight { text-decoration-thickness: 4px; }
</style>
<div class="lx-animated-wrapper lx-gif-optimized">
  <div class="lx-attributes-panel">
    <div class="lx-legend">Highlights Legend: <span class="lx-label" style="background-color:#D2E3FC;">Background</span> <span class="lx-label" style="background-color:#C8E6C9;">Methodology</span> <span class="lx-label" style="background-color:#FEF0C3;">Results</span></div>
    <div id="attributesContainer"></div>
  </div>
  <div class="lx-text-window" id="textWindow">
    There is consensus among scholars and policy makers that <span class="lx-highlight lx-current-highlight" data-idx="0" style="background-color:#D2E3FC;">knowledge is</span> one of the key drivers of long-run economic growth. It is also clear from the literature that <span class="lx-highlight" data-idx="1" style="background-color:#D2E3FC;">not all knowledge has</span> the same value. However, too often in economic geography and cognate fields we have been obsessed with counting knowledge inputs and outputs rather than assessing the quality of knowledge produced. In this article we measure the complexity of knowledge, we map the distribution and the evolution of knowledge complexity in US cities, and we explore how the spatial diffusion of knowledge is linked to complexity<span class="lx-highlight" data-idx="2" style="background-color:#C8E6C9;">. Our knowledge complexity index rests on the bimodal network models of Hidalgo and Hausmann.</span> Analysis is based on more than two million patent records from the US Patent and Trademark Office that identify the technological structure of US metropolitan areas in terms of the patent classes in which they are most active between 1975 and 2010. We find that <span class="lx-highlight" data-idx="3" style="background-color:#FEF0C3;">knowledge complexity is unevenly distributed across</span> the United States and that <span class="lx-highlight" data-idx="4" style="background-color:#FEF0C3;">cities with the most complex technological structures are not necessarily those with the highest</span> rates of patenting. Citation data indicate that <span class="lx-highlight" data-idx="5" style="background-color:#FEF0C3;">more complex patents are less likely to be cited</span> than less complex patents when citing and cited patents are located in different metropolitan areas.
  </div>
  <div class="lx-controls">
    <div class="lx-button-row">
      <button class="lx-control-btn" onclick="playPause()">▶️ Play</button>
      <button class="lx-control-btn" onclick="prevExtraction()">⏮ Previous</button>
      <button class="lx-control-btn" onclick="nextExtraction()">⏭ Next</button>
    </div>
    <div class="lx-progress-container">
      <input type="range" id="progressSlider" class="lx-progress-slider"
             min="0" max="5" value="0"
             onchange="jumpToExtraction(this.value)">
    </div>
    <div class="lx-status-text">
      Entity <span id="entityInfo">1/6</span> |
      Pos <span id="posInfo">[57-69]</span>
    </div>
  </div>
</div>

<script>
  (function() {
    const extractions = [{"index": 0, "class": "Background", "text": "Knowledge is a key driver of long-run economic growth.", "color": "#D2E3FC", "startPos": 57, "endPos": 69, "beforeText": "There is consensus among scholars and policy makers that ", "extractionText": "knowledge is", "afterText": " one of the key drivers of long-run economic growth. It is also clear from the literature that not all knowledge has the same value. However, too ofte", "attributesHtml": "<div><strong>class:</strong> Background</div><div><strong>attributes:</strong> {}</div>"}, {"index": 1, "class": "Background", "text": "Not all knowledge has equal value, yet many studies focus on counting inputs and outputs rather than assessing quality.", "color": "#D2E3FC", "startPos": 164, "endPos": 185, "beforeText": "nsus among scholars and policy makers that knowledge is one of the key drivers of long-run economic growth. It is also clear from the literature that ", "extractionText": "not all knowledge has", "afterText": " the same value. However, too often in economic geography and cognate fields we have been obsessed with counting knowledge inputs and outputs rather t", "attributesHtml": "<div><strong>class:</strong> Background</div><div><strong>attributes:</strong> {}</div>"}, {"index": 2, "class": "Methodology", "text": "Develop a knowledge complexity index based on the bimodal network models of Hidalgo and Hausmann.", "color": "#C8E6C9", "startPos": 597, "endPos": 690, "beforeText": "the distribution and the evolution of knowledge complexity in US cities, and we explore how the spatial diffusion of knowledge is linked to complexity", "extractionText": ". Our knowledge complexity index rests on the bimodal network models of Hidalgo and Hausmann.", "afterText": " Analysis is based on more than two million patent records from the US Patent and Trademark Office that identify the technological structure of US met", "attributesHtml": "<div><strong>class:</strong> Methodology</div><div><strong>attributes:</strong> {}</div>"}, {"index": 3, "class": "Results", "text": "Knowledge complexity is unevenly distributed across U.S. cities.", "color": "#FEF0C3", "startPos": 953, "endPos": 1004, "beforeText": "the technological structure of US metropolitan areas in terms of the patent classes in which they are most active between 1975 and 2010. We find that ", "extractionText": "knowledge complexity is unevenly distributed across", "afterText": " the United States and that cities with the most complex technological structures are not necessarily those with the highest rates of patenting. Citat", "attributesHtml": "<div><strong>class:</strong> Results</div><div><strong>attributes:</strong> {}</div>"}, {"index": 4, "class": "Results", "text": "Cities with the most complex technological structures are not necessarily those with the highest patenting rates.", "color": "#FEF0C3", "startPos": 1032, "endPos": 1128, "beforeText": "sses in which they are most active between 1975 and 2010. We find that knowledge complexity is unevenly distributed across the United States and that ", "extractionText": "cities with the most complex technological structures are not necessarily those with the highest", "afterText": " rates of patenting. Citation data indicate that more complex patents are less likely to be cited than less complex patents when citing and cited pate", "attributesHtml": "<div><strong>class:</strong> Results</div><div><strong>attributes:</strong> {}</div>"}, {"index": 5, "class": "Results", "text": "More complex patents are less likely to be cited when citing and cited patents reside in different metropolitan areas.", "color": "#FEF0C3", "startPos": 1177, "endPos": 1225, "beforeText": "that cities with the most complex technological structures are not necessarily those with the highest rates of patenting. Citation data indicate that ", "extractionText": "more complex patents are less likely to be cited", "afterText": " than less complex patents when citing and cited patents are located in different metropolitan areas.", "attributesHtml": "<div><strong>class:</strong> Results</div><div><strong>attributes:</strong> {}</div>"}];
    let currentIndex = 0;
    let isPlaying = false;
    let animationInterval = null;
    let animationSpeed = 1.0;

    function updateDisplay() {
      const extraction = extractions[currentIndex];
      if (!extraction) return;

      document.getElementById('attributesContainer').innerHTML = extraction.attributesHtml;
      document.getElementById('entityInfo').textContent = (currentIndex + 1) + '/' + extractions.length;
      document.getElementById('posInfo').textContent = '[' + extraction.startPos + '-' + extraction.endPos + ']';
      document.getElementById('progressSlider').value = currentIndex;

      const playBtn = document.querySelector('.lx-control-btn');
      if (playBtn) playBtn.textContent = isPlaying ? '⏸ Pause' : '▶️ Play';

      const prevHighlight = document.querySelector('.lx-text-window .lx-current-highlight');
      if (prevHighlight) prevHighlight.classList.remove('lx-current-highlight');
      const currentSpan = document.querySelector('.lx-text-window span[data-idx="' + currentIndex + '"]');
      if (currentSpan) {
        currentSpan.classList.add('lx-current-highlight');
        currentSpan.scrollIntoView({block: 'center', behavior: 'smooth'});
      }
    }

    function nextExtraction() {
      currentIndex = (currentIndex + 1) % extractions.length;
      updateDisplay();
    }

    function prevExtraction() {
      currentIndex = (currentIndex - 1 + extractions.length) % extractions.length;
      updateDisplay();
    }

    function jumpToExtraction(index) {
      currentIndex = parseInt(index);
      updateDisplay();
    }

    function playPause() {
      if (isPlaying) {
        clearInterval(animationInterval);
        isPlaying = false;
      } else {
        animationInterval = setInterval(nextExtraction, animationSpeed * 1000);
        isPlaying = true;
      }
      updateDisplay();
    }

    window.playPause = playPause;
    window.nextExtraction = nextExtraction;
    window.prevExtraction = prevExtraction;
    window.jumpToExtraction = jumpToExtraction;

    updateDisplay();
  })();
</script>