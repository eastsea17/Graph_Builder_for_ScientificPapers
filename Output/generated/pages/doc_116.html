<style>
.lx-highlight { position: relative; border-radius:3px; padding:1px 2px;}
.lx-highlight .lx-tooltip {
  visibility: hidden;
  opacity: 0;
  transition: opacity 0.2s ease-in-out;
  background: #333;
  color: #fff;
  text-align: left;
  border-radius: 4px;
  padding: 6px 8px;
  position: absolute;
  z-index: 1000;
  bottom: 125%;
  left: 50%;
  transform: translateX(-50%);
  font-size: 12px;
  max-width: 240px;
  white-space: normal;
  box-shadow: 0 2px 6px rgba(0,0,0,0.3);
}
.lx-highlight:hover .lx-tooltip { visibility: visible; opacity:1; }
.lx-animated-wrapper { max-width: 100%; font-family: Arial, sans-serif; }
.lx-controls {
  background: #fafafa; border: 1px solid #90caf9; border-radius: 8px;
  padding: 12px; margin-bottom: 16px;
}
.lx-button-row {
  display: flex; justify-content: center; gap: 8px; margin-bottom: 12px;
}
.lx-control-btn {
  background: #4285f4; color: white; border: none; border-radius: 4px;
  padding: 8px 16px; cursor: pointer; font-size: 13px; font-weight: 500;
  transition: background-color 0.2s;
}
.lx-control-btn:hover { background: #3367d6; }
.lx-progress-container {
  margin-bottom: 8px;
}
.lx-progress-slider {
  width: 100%; margin: 0; appearance: none; height: 6px;
  background: #ddd; border-radius: 3px; outline: none;
}
.lx-progress-slider::-webkit-slider-thumb {
  appearance: none; width: 18px; height: 18px; background: #4285f4;
  border-radius: 50%; cursor: pointer;
}
.lx-progress-slider::-moz-range-thumb {
  width: 18px; height: 18px; background: #4285f4; border-radius: 50%;
  cursor: pointer; border: none;
}
.lx-status-text {
  text-align: center; font-size: 12px; color: #666; margin-top: 4px;
}
.lx-text-window {
  font-family: monospace; white-space: pre-wrap; border: 1px solid #90caf9;
  padding: 12px; max-height: 260px; overflow-y: auto; margin-bottom: 12px;
  line-height: 1.6;
}
.lx-attributes-panel {
  background: #fafafa; border: 1px solid #90caf9; border-radius: 6px;
  padding: 8px 10px; margin-top: 8px; font-size: 13px;
}
.lx-current-highlight {
  border-bottom: 4px solid #ff4444;
  font-weight: bold;
  animation: lx-pulse 1s ease-in-out;
}
@keyframes lx-pulse {
  0% { text-decoration-color: #ff4444; }
  50% { text-decoration-color: #ff0000; }
  100% { text-decoration-color: #ff4444; }
}
.lx-legend {
  font-size: 12px; margin-bottom: 8px;
  padding-bottom: 8px; border-bottom: 1px solid #e0e0e0;
}
.lx-label {
  display: inline-block;
  padding: 2px 4px;
  border-radius: 3px;
  margin-right: 4px;
  color: #000;
}
.lx-attr-key {
  font-weight: 600;
  color: #1565c0;
  letter-spacing: 0.3px;
}
.lx-attr-value {
  font-weight: 400;
  opacity: 0.85;
  letter-spacing: 0.2px;
}

/* Add optimizations with larger fonts and better readability for GIFs */
.lx-gif-optimized .lx-text-window { font-size: 16px; line-height: 1.8; }
.lx-gif-optimized .lx-attributes-panel { font-size: 15px; }
.lx-gif-optimized .lx-current-highlight { text-decoration-thickness: 4px; }
</style>
<div class="lx-animated-wrapper lx-gif-optimized">
  <div class="lx-attributes-panel">
    <div class="lx-legend">Highlights Legend: <span class="lx-label" style="background-color:#D2E3FC;">Purpose</span> <span class="lx-label" style="background-color:#C8E6C9;">Results</span></div>
    <div id="attributesContainer"></div>
  </div>
  <div class="lx-text-window" id="textWindow">
    Network Meta-analysis was performed <span class="lx-highlight lx-current-highlight" data-idx="0" style="background-color:#D2E3FC;">to systematically compare the efficacy of different Chinese patent medicines for activating blood and resolving stasis in the treatment of endometriosis and <span class="lx-highlight" data-idx="1" style="background-color:#D2E3FC;">to provide evidence-based references for clinical medication regimens.</span> The relevant randomized controlled trials(RCTs) involving Chinese patent medicines combined with conventional treatment(experimental group) vs conventional treatment(control group) were retrieved from Chinese and English literature databases. The bias risk assessment tool recommended in Cochrane handbook 5.3 was used to evaluate the quality of the included studies. The result data of each outcome index was extracted for network Meta-analysis in Stata 15.</span>0. A total of 44 RCTs were included in this study, involving 4 345 patients and 9 Chinese patent medicines. The network Meta-analysis revealed the following trends.(1)In terms of reducing the visual analogue scale(VAS) scores, Dan&#x27;e Fukang Plaster+conventional treatment&amp;gt;Xuefu Zhuyu Capsules+conventional treatment&amp;gt;Gongliuxiao Capsules+conventional treatment.(2)In terms of reducing cancer antigen CA125, Xiaojin Capsules+conventional treatment&amp;gt;Shaofu Zhuyu Granules+conventional treatment&amp;gt;Dan&#x27;e Fukang Plaster+conventional treatment.(3)In terms of reducing estradiol(E_2), Gongliuxiao Capsules+conventional treatment&amp;gt;Xiaojin Capsules+conventional treatment&amp;gt;Sanjie Zhentong Capsules+conventional treatment.(4) In terms of reducing recurrence rate, Guizhi Fuling Capsules+conventional treatment&amp;gt;Xuefu Zhuyu Capsules+conventional treatment&amp;gt;Dan&#x27;e Fukang Plaster+conventional treatment. The <span class="lx-highlight" data-idx="2" style="background-color:#C8E6C9;">peroral Chinese patent medicines</span> for activating blood and resolving stasis combined with conventional treatment have better efficacy in the treatment of endometriosis than conventional treatment. However, considering the low quality of the included literature, large-scale high-quality clinical trials are needed in the future research.
  </div>
  <div class="lx-controls">
    <div class="lx-button-row">
      <button class="lx-control-btn" onclick="playPause()">▶️ Play</button>
      <button class="lx-control-btn" onclick="prevExtraction()">⏮ Previous</button>
      <button class="lx-control-btn" onclick="nextExtraction()">⏭ Next</button>
    </div>
    <div class="lx-progress-container">
      <input type="range" id="progressSlider" class="lx-progress-slider"
             min="0" max="2" value="0"
             onchange="jumpToExtraction(this.value)">
    </div>
    <div class="lx-status-text">
      Entity <span id="entityInfo">1/3</span> |
      Pos <span id="posInfo">[36-722]</span>
    </div>
  </div>
</div>

<script>
  (function() {
    const extractions = [{"index": 0, "class": "Purpose", "text": "To systematically compare the efficacy of various Chinese patent medicines combined with conventional treatment for endometriosis using a network meta\u2011analysis.", "color": "#D2E3FC", "startPos": 36, "endPos": 722, "beforeText": "Network Meta-analysis was performed ", "extractionText": "to systematically compare the efficacy of different Chinese patent medicines for activating blood and resolving stasis in the treatment of endometriosis and to provide evidence-based references for clinical medication regimens. The relevant randomized controlled trials(RCTs) involving Chinese patent medicines combined with conventional treatment(experimental group) vs conventional treatment(control group) were retrieved from Chinese and English literature databases. The bias risk assessment tool recommended in Cochrane handbook 5.3 was used to evaluate the quality of the included studies. The result data of each outcome index was extracted for network Meta-analysis in Stata 15.", "afterText": "0. A total of 44 RCTs were included in this study, involving 4 345 patients and 9 Chinese patent medicines. The network Meta-analysis revealed the fol", "attributesHtml": "<div><strong>class:</strong> Purpose</div><div><strong>attributes:</strong> {}</div>"}, {"index": 1, "class": "Purpose", "text": "To provide evidence\u2011based guidance for clinical medication regimens.", "color": "#D2E3FC", "startPos": 193, "endPos": 263, "beforeText": "ematically compare the efficacy of different Chinese patent medicines for activating blood and resolving stasis in the treatment of endometriosis and ", "extractionText": "to provide evidence-based references for clinical medication regimens.", "afterText": " The relevant randomized controlled trials(RCTs) involving Chinese patent medicines combined with conventional treatment(experimental group) vs conven", "attributesHtml": "<div><strong>class:</strong> Purpose</div><div><strong>attributes:</strong> {}</div>"}, {"index": 2, "class": "Results", "text": "Peroral Chinese patent medicines plus conventional therapy reduced VAS pain scores, CA125, estradiol levels, and recurrence rates more than conventional therapy alone, with specific rankings among the medicines.", "color": "#C8E6C9", "startPos": 1633, "endPos": 1665, "beforeText": "ate, Guizhi Fuling Capsules+conventional treatment&amp;gt;Xuefu Zhuyu Capsules+conventional treatment&amp;gt;Dan&#x27;e Fukang Plaster+conventional treatment. The ", "extractionText": "peroral Chinese patent medicines", "afterText": " for activating blood and resolving stasis combined with conventional treatment have better efficacy in the treatment of endometriosis than convention", "attributesHtml": "<div><strong>class:</strong> Results</div><div><strong>attributes:</strong> {}</div>"}];
    let currentIndex = 0;
    let isPlaying = false;
    let animationInterval = null;
    let animationSpeed = 1.0;

    function updateDisplay() {
      const extraction = extractions[currentIndex];
      if (!extraction) return;

      document.getElementById('attributesContainer').innerHTML = extraction.attributesHtml;
      document.getElementById('entityInfo').textContent = (currentIndex + 1) + '/' + extractions.length;
      document.getElementById('posInfo').textContent = '[' + extraction.startPos + '-' + extraction.endPos + ']';
      document.getElementById('progressSlider').value = currentIndex;

      const playBtn = document.querySelector('.lx-control-btn');
      if (playBtn) playBtn.textContent = isPlaying ? '⏸ Pause' : '▶️ Play';

      const prevHighlight = document.querySelector('.lx-text-window .lx-current-highlight');
      if (prevHighlight) prevHighlight.classList.remove('lx-current-highlight');
      const currentSpan = document.querySelector('.lx-text-window span[data-idx="' + currentIndex + '"]');
      if (currentSpan) {
        currentSpan.classList.add('lx-current-highlight');
        currentSpan.scrollIntoView({block: 'center', behavior: 'smooth'});
      }
    }

    function nextExtraction() {
      currentIndex = (currentIndex + 1) % extractions.length;
      updateDisplay();
    }

    function prevExtraction() {
      currentIndex = (currentIndex - 1 + extractions.length) % extractions.length;
      updateDisplay();
    }

    function jumpToExtraction(index) {
      currentIndex = parseInt(index);
      updateDisplay();
    }

    function playPause() {
      if (isPlaying) {
        clearInterval(animationInterval);
        isPlaying = false;
      } else {
        animationInterval = setInterval(nextExtraction, animationSpeed * 1000);
        isPlaying = true;
      }
      updateDisplay();
    }

    window.playPause = playPause;
    window.nextExtraction = nextExtraction;
    window.prevExtraction = prevExtraction;
    window.jumpToExtraction = jumpToExtraction;

    updateDisplay();
  })();
</script>