<style>
.lx-highlight { position: relative; border-radius:3px; padding:1px 2px;}
.lx-highlight .lx-tooltip {
  visibility: hidden;
  opacity: 0;
  transition: opacity 0.2s ease-in-out;
  background: #333;
  color: #fff;
  text-align: left;
  border-radius: 4px;
  padding: 6px 8px;
  position: absolute;
  z-index: 1000;
  bottom: 125%;
  left: 50%;
  transform: translateX(-50%);
  font-size: 12px;
  max-width: 240px;
  white-space: normal;
  box-shadow: 0 2px 6px rgba(0,0,0,0.3);
}
.lx-highlight:hover .lx-tooltip { visibility: visible; opacity:1; }
.lx-animated-wrapper { max-width: 100%; font-family: Arial, sans-serif; }
.lx-controls {
  background: #fafafa; border: 1px solid #90caf9; border-radius: 8px;
  padding: 12px; margin-bottom: 16px;
}
.lx-button-row {
  display: flex; justify-content: center; gap: 8px; margin-bottom: 12px;
}
.lx-control-btn {
  background: #4285f4; color: white; border: none; border-radius: 4px;
  padding: 8px 16px; cursor: pointer; font-size: 13px; font-weight: 500;
  transition: background-color 0.2s;
}
.lx-control-btn:hover { background: #3367d6; }
.lx-progress-container {
  margin-bottom: 8px;
}
.lx-progress-slider {
  width: 100%; margin: 0; appearance: none; height: 6px;
  background: #ddd; border-radius: 3px; outline: none;
}
.lx-progress-slider::-webkit-slider-thumb {
  appearance: none; width: 18px; height: 18px; background: #4285f4;
  border-radius: 50%; cursor: pointer;
}
.lx-progress-slider::-moz-range-thumb {
  width: 18px; height: 18px; background: #4285f4; border-radius: 50%;
  cursor: pointer; border: none;
}
.lx-status-text {
  text-align: center; font-size: 12px; color: #666; margin-top: 4px;
}
.lx-text-window {
  font-family: monospace; white-space: pre-wrap; border: 1px solid #90caf9;
  padding: 12px; max-height: 260px; overflow-y: auto; margin-bottom: 12px;
  line-height: 1.6;
}
.lx-attributes-panel {
  background: #fafafa; border: 1px solid #90caf9; border-radius: 6px;
  padding: 8px 10px; margin-top: 8px; font-size: 13px;
}
.lx-current-highlight {
  border-bottom: 4px solid #ff4444;
  font-weight: bold;
  animation: lx-pulse 1s ease-in-out;
}
@keyframes lx-pulse {
  0% { text-decoration-color: #ff4444; }
  50% { text-decoration-color: #ff0000; }
  100% { text-decoration-color: #ff4444; }
}
.lx-legend {
  font-size: 12px; margin-bottom: 8px;
  padding-bottom: 8px; border-bottom: 1px solid #e0e0e0;
}
.lx-label {
  display: inline-block;
  padding: 2px 4px;
  border-radius: 3px;
  margin-right: 4px;
  color: #000;
}
.lx-attr-key {
  font-weight: 600;
  color: #1565c0;
  letter-spacing: 0.3px;
}
.lx-attr-value {
  font-weight: 400;
  opacity: 0.85;
  letter-spacing: 0.2px;
}

/* Add optimizations with larger fonts and better readability for GIFs */
.lx-gif-optimized .lx-text-window { font-size: 16px; line-height: 1.8; }
.lx-gif-optimized .lx-attributes-panel { font-size: 15px; }
.lx-gif-optimized .lx-current-highlight { text-decoration-thickness: 4px; }
</style>
<div class="lx-animated-wrapper lx-gif-optimized">
  <div class="lx-attributes-panel">
    <div class="lx-legend">Highlights Legend: <span class="lx-label" style="background-color:#D2E3FC;">Background</span> <span class="lx-label" style="background-color:#C8E6C9;">Methodology</span> <span class="lx-label" style="background-color:#FEF0C3;">Results</span></div>
    <div id="attributesContainer"></div>
  </div>
  <div class="lx-text-window" id="textWindow">
    Objective To examine the relative impact of <span class="lx-highlight lx-current-highlight" data-idx="0" style="background-color:#D2E3FC;">three management options in <span class="lx-highlight" data-idx="1" style="background-color:#D2E3FC;">patients</span> aged &amp;lt;60 years with cryptogenic stroke and a patent foramen ovale (PFO): PFO closure plus antiplatelet therapy, antiplatelet therapy alone and anticoagulation alone.</span> Design <span class="lx-highlight" data-idx="2" style="background-color:#C8E6C9;">Systematic review and network meta</span>-analysis (NMA) supported by complementary external evidence. Data sources Medline, EMBASE and Cochrane CENTRAL. Study selection Randomised controlled trials (RCTs) addressing PFO closure and/or medical therapies in patients with PFO and cryptogenic stroke. Review methods We conducted an NMA complemented with external evidence and rated certainty of evidence using the Grading of Recommendations Assessment, Development and Evaluation (GRADE) system. Results <span class="lx-highlight" data-idx="3" style="background-color:#FEF0C3;">Ten RCTs</span> in eight studies proved eligible (n=4416). Seven RCTs (n=3913) addressed <span class="lx-highlight" data-idx="4" style="background-color:#FEF0C3;">PFO closure</span> versus medical therapy. Of these, three (n=1257) addressed PFO closure versus antiplatelet therapy, three (n=2303) addressed PFO closure versus mixed antiplatelet and anticoagulation therapies and one (n=353) addressed PFO closure versus anticoagulation. The remaining three RCTs (n=503) addressed anticoagulant versus antiplatelet therapy. PFO closure versus antiplatelet therapy probably results in substantial reduction in ischaemic stroke recurrence (risk difference per 1000 patients over 5 years (RD): −87, 95% credible interval (CrI) −100 to −33; moderate certainty). Compared with anticoagulation, <span class="lx-highlight" data-idx="5" style="background-color:#FEF0C3;">PFO closure</span> may confer little or no difference in ischaemic stroke recurrence (low certainty) but probably has a lower risk of major bleeding (RD −20, 95% CrI −27 to −2, moderate certainty). Relative to either medical therapy, PFO closure probably increases the risk of persistent atrial fibrillation (RD 18, 95% CI +5 to +56, moderate certainty) and device-related adverse events (RD +36, 95% CI +23 to +50, high certainty). Anticoagulation, compared with antiplatelet therapy, may reduce the risk of ischaemic stroke recurrence (RD −71, 95% CrI −100 to +17, low certainty), but probably increases the risk of major bleeding (RD +12, 95% CrI −5 to +65, moderate certainty). Conclusions In patients aged &amp;lt;60 years, PFO closure probably confers an important reduction in ischaemic stroke recurrence compared with antiplatelet therapy alone but may make no difference compared with anticoagulation. PFO closure incurs a risk of persistent atrial fibrillation and device-related adverse events. Compared with alternatives, anticoagulation probably increases major bleeding. PROSPERO registration number CRD42017081567.
  </div>
  <div class="lx-controls">
    <div class="lx-button-row">
      <button class="lx-control-btn" onclick="playPause()">▶️ Play</button>
      <button class="lx-control-btn" onclick="prevExtraction()">⏮ Previous</button>
      <button class="lx-control-btn" onclick="nextExtraction()">⏭ Next</button>
    </div>
    <div class="lx-progress-container">
      <input type="range" id="progressSlider" class="lx-progress-slider"
             min="0" max="5" value="0"
             onchange="jumpToExtraction(this.value)">
    </div>
    <div class="lx-status-text">
      Entity <span id="entityInfo">1/6</span> |
      Pos <span id="posInfo">[72-80]</span>
    </div>
  </div>
</div>

<script>
  (function() {
    const extractions = [{"index": 0, "class": "Background", "text": "Three main treatment options exist: PFO closure plus antiplatelet therapy, antiplatelet therapy alone, and anticoagulation alone.", "color": "#D2E3FC", "startPos": 44, "endPos": 249, "beforeText": "Objective To examine the relative impact of ", "extractionText": "three management options in patients aged &amp;lt;60 years with cryptogenic stroke and a patent foramen ovale (PFO): PFO closure plus antiplatelet therapy, antiplatelet therapy alone and anticoagulation alone.", "afterText": " Design Systematic review and network meta-analysis (NMA) supported by complementary external evidence. Data sources Medline, EMBASE and Cochrane CENT", "attributesHtml": "<div><strong>class:</strong> Background</div><div><strong>attributes:</strong> {}</div>"}, {"index": 1, "class": "Background", "text": "Patients under 60 with cryptogenic stroke and a patent foramen ovale (PFO) have uncertain optimal management.", "color": "#D2E3FC", "startPos": 72, "endPos": 80, "beforeText": "Objective To examine the relative impact of three management options in ", "extractionText": "patients", "afterText": " aged &amp;lt;60 years with cryptogenic stroke and a patent foramen ovale (PFO): PFO closure plus antiplatelet therapy, antiplatelet therapy alone and ant", "attributesHtml": "<div><strong>class:</strong> Background</div><div><strong>attributes:</strong> {}</div>"}, {"index": 2, "class": "Methodology", "text": "Systematic review and network meta\u2011analysis of randomized controlled trials (RCTs) identified from Medline, EMBASE, and Cochrane CENTRAL.", "color": "#C8E6C9", "startPos": 257, "endPos": 291, "beforeText": "ptogenic stroke and a patent foramen ovale (PFO): PFO closure plus antiplatelet therapy, antiplatelet therapy alone and anticoagulation alone. Design ", "extractionText": "Systematic review and network meta", "afterText": "-analysis (NMA) supported by complementary external evidence. Data sources Medline, EMBASE and Cochrane CENTRAL. Study selection Randomised controlled", "attributesHtml": "<div><strong>class:</strong> Methodology</div><div><strong>attributes:</strong> {}</div>"}, {"index": 3, "class": "Results", "text": "Ten RCTs (4416 participants) met inclusion criteria.", "color": "#FEF0C3", "startPos": 752, "endPos": 760, "beforeText": "external evidence and rated certainty of evidence using the Grading of Recommendations Assessment, Development and Evaluation (GRADE) system. Results ", "extractionText": "Ten RCTs", "afterText": " in eight studies proved eligible (n=4416). Seven RCTs (n=3913) addressed PFO closure versus medical therapy. Of these, three (n=1257) addressed PFO c", "attributesHtml": "<div><strong>class:</strong> Results</div><div><strong>attributes:</strong> {}</div>"}, {"index": 4, "class": "Results", "text": "PFO closure vs antiplatelet therapy likely reduces ischaemic stroke recurrence (risk difference \u221287 per 1000 over 5\u202fyears; moderate certainty).", "color": "#FEF0C3", "startPos": 834, "endPos": 845, "beforeText": "ions Assessment, Development and Evaluation (GRADE) system. Results Ten RCTs in eight studies proved eligible (n=4416). Seven RCTs (n=3913) addressed ", "extractionText": "PFO closure", "afterText": " versus medical therapy. Of these, three (n=1257) addressed PFO closure versus antiplatelet therapy, three (n=2303) addressed PFO closure versus mixed", "attributesHtml": "<div><strong>class:</strong> Results</div><div><strong>attributes:</strong> {}</div>"}, {"index": 5, "class": "Results", "text": "PFO closure vs anticoagulation shows little difference in stroke recurrence (low certainty) but likely lowers major bleeding risk (risk difference \u221220 per 1000; moderate certainty).", "color": "#FEF0C3", "startPos": 1452, "endPos": 1463, "beforeText": "isk difference per 1000 patients over 5 years (RD): \u221287, 95% credible interval (CrI) \u2212100 to \u221233; moderate certainty). Compared with anticoagulation, ", "extractionText": "PFO closure", "afterText": " may confer little or no difference in ischaemic stroke recurrence (low certainty) but probably has a lower risk of major bleeding (RD \u221220, 95% CrI \u22122", "attributesHtml": "<div><strong>class:</strong> Results</div><div><strong>attributes:</strong> {}</div>"}];
    let currentIndex = 0;
    let isPlaying = false;
    let animationInterval = null;
    let animationSpeed = 1.0;

    function updateDisplay() {
      const extraction = extractions[currentIndex];
      if (!extraction) return;

      document.getElementById('attributesContainer').innerHTML = extraction.attributesHtml;
      document.getElementById('entityInfo').textContent = (currentIndex + 1) + '/' + extractions.length;
      document.getElementById('posInfo').textContent = '[' + extraction.startPos + '-' + extraction.endPos + ']';
      document.getElementById('progressSlider').value = currentIndex;

      const playBtn = document.querySelector('.lx-control-btn');
      if (playBtn) playBtn.textContent = isPlaying ? '⏸ Pause' : '▶️ Play';

      const prevHighlight = document.querySelector('.lx-text-window .lx-current-highlight');
      if (prevHighlight) prevHighlight.classList.remove('lx-current-highlight');
      const currentSpan = document.querySelector('.lx-text-window span[data-idx="' + currentIndex + '"]');
      if (currentSpan) {
        currentSpan.classList.add('lx-current-highlight');
        currentSpan.scrollIntoView({block: 'center', behavior: 'smooth'});
      }
    }

    function nextExtraction() {
      currentIndex = (currentIndex + 1) % extractions.length;
      updateDisplay();
    }

    function prevExtraction() {
      currentIndex = (currentIndex - 1 + extractions.length) % extractions.length;
      updateDisplay();
    }

    function jumpToExtraction(index) {
      currentIndex = parseInt(index);
      updateDisplay();
    }

    function playPause() {
      if (isPlaying) {
        clearInterval(animationInterval);
        isPlaying = false;
      } else {
        animationInterval = setInterval(nextExtraction, animationSpeed * 1000);
        isPlaying = true;
      }
      updateDisplay();
    }

    window.playPause = playPause;
    window.nextExtraction = nextExtraction;
    window.prevExtraction = prevExtraction;
    window.jumpToExtraction = jumpToExtraction;

    updateDisplay();
  })();
</script>